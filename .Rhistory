)
taxable_income_by_CG <-
just_negative_gearing_taxstats %>%
group_by(HasCG = Net_CG_amt > 0) %>%
summarise(mean.tx.i = mean(new_Taxable_Income)) %>%
mutate(mean.tx = income_tax(mean.tx.i, fy.year = "2012-13"),
marginal.tax.of.avg = income_tax(mean.tx.i, fy.year = "2012-13") - income_tax(mean.tx.i - 1, fy.year = "2012-13")) %>%
select(HasCG, marginal.tax.of.avg) %>%
data.table
just_negative_gearing_taxstats_year0 <- just_negative_gearing_taxstats
for (i in 1:20){
just_negative_gearing_taxstats %<>%
mutate(rand = runif(nrow(.))) %>%
mutate(loss_carry_fwd_orig = loss_ignore_CG) %>%
mutate(noCGevent = rand < prob_of_noCG_if_investor201213) %>%
mutate(HasCG = !noCGevent) %>%
merge(taxable_income_by_CG, by = "HasCG") %>%
mutate(
new_tax = ifelse(noCGevent,
income_tax(new_Taxable_Income, fy.year = fy.year),
# Should negative taxes be included? Answer not yet obvious.
pmax(0, income_tax(new_Taxable_Income, fy.year = fy.year) - marginal.tax.of.avg * loss_carry_fwd_orig * (i - whenCG.lastoccurred))),
whenCG.lastoccurred.prev = whenCG.lastoccurred,
# reset if applicable
whenCG.lastoccurred = ifelse(!noCGevent, i, whenCG.lastoccurred)
) %>%
select(-marginal.tax.of.avg)
if (i == 20)
just_negative_gearing_taxstats %<>% mutate(diff = new_tax - current_tax)
}
# 3 billion in savings upfront.
tax2013 <- fread(sample_file_of(2013))
prob_of_noCG_if_investor201213 <-
tax2013 %>%
group_by(
IsInvestor = Gross_rent_amt > 0,
HasCG = Net_CG_amt > 0
) %>%
tally %>%
ungroup %>%
group_by(IsInvestor) %>%
mutate(prop = n/sum(n)) %>%
filter(IsInvestor, !HasCG) %$%
prop
just_negative_gearing_taxstats <-
tax2013 %>%
mutate(
income_no_salary = Tot_inc_amt - Net_rent_amt - Sw_amt - Alow_ben_amt - ETP_txbl_amt,
#
# This is not quite true: it doesn't include medical offsets.
# You can only deduct Net_rent down to zero.
# Include financial losses in deductions
# Full tax on Sw_amt. Then deductions
new_Taxable_Income =  pmax(0, income_no_salary + Net_rent_amt - Net_fincl_invstmt_lss_amt) + Sw_amt + Alow_ben_amt + ETP_txbl_amt - Tot_ded_amt - PP_loss_claimed - NPP_loss_claimed,
loss_ignore_CG = -1 * pmin(0, pmax(0, income_no_salary - Net_CG_amt) + Net_rent_amt),
old_Taxable_Income_no_offset = Tot_inc_amt - Tot_ded_amt - PP_loss_claimed - NPP_loss_claimed,
#
new_tax = income_tax(new_Taxable_Income),
current_tax = income_tax(Taxable_Income),
whenCG.lastoccurred = 0L
)
taxable_income_by_CG <-
just_negative_gearing_taxstats %>%
group_by(HasCG = Net_CG_amt > 0) %>%
summarise(mean.tx.i = mean(new_Taxable_Income)) %>%
mutate(mean.tx = income_tax(mean.tx.i, fy.year = "2012-13"),
marginal.tax.of.avg = income_tax(mean.tx.i, fy.year = "2012-13") - income_tax(mean.tx.i - 1, fy.year = "2012-13")) %>%
select(HasCG, marginal.tax.of.avg) %>%
data.table
just_negative_gearing_taxstats_year0 <- just_negative_gearing_taxstats
for (i in 1:20){
just_negative_gearing_taxstats %<>%
mutate(rand = runif(nrow(.))) %>%
mutate(loss_carry_fwd_orig = loss_ignore_CG) %>%
mutate(noCGevent = rand < prob_of_noCG_if_investor201213) %>%
mutate(HasCG = !noCGevent) %>%
merge(taxable_income_by_CG, by = "HasCG") %>%
mutate(
new_tax = ifelse(noCGevent,
income_tax(new_Taxable_Income, fy.year = "2012-13"),
# Should negative taxes be included? Answer not yet obvious.
pmax(0, income_tax(new_Taxable_Income, fy.year = "2012-13") - marginal.tax.of.avg * loss_carry_fwd_orig * (i - whenCG.lastoccurred))),
whenCG.lastoccurred.prev = whenCG.lastoccurred,
# reset if applicable
whenCG.lastoccurred = ifelse(!noCGevent, i, whenCG.lastoccurred)
) %>%
select(-marginal.tax.of.avg)
if (i == 20)
just_negative_gearing_taxstats %<>% mutate(diff = new_tax - current_tax)
}
# 3 billion in savings upfront.
just_negative_gearing_taxstats %$% sum(diff)*50
just_negative_gearing_taxstats %$% sum(diff)*50/1e9
just_negative_gearing_taxstats %>% group_by(Gender) %>% summarise(avg.diff = 50*sum(diff)/1e9)
# This is a functional version of the above. It's designed to be easier to read,
# not fast to run.  Beware.
cost_of_daley_policy <- function(year = 2013, eventual = 20, CGT.discount = 0.30){
fy.year <- yr2fy(year)
if (year >= 2014){
# Inflate the wages for future years.  Adjust the variables which depend on Sw_amt
# accordingly (otherwise the difference just becomes smaller).
daley_taxstats <-
fread(sample_file_of(2013)) %>%
mutate(
Taxable_Income = Taxable_Income - Sw_amt + Sw_amt * (wage_inflator(from_fy = "2012-13", to_fy = "2013-14"))^(year - 2013),
Tot_inc_amt = Tot_inc_amt - Sw_amt + Sw_amt * (wage_inflator(from_fy = "2012-13", to_fy = "2013-14"))^(year - 2013),
Sw_amt = Sw_amt * (wage_inflator(from_fy = "2012-13", to_fy = "2013-14"))^(year - 2013)
)
} else {
daley_taxstats <-
# fread(sample_file_of(2013)) %>%
fread(sample_file_of(year = year))
}
# Year specific housekeeping
# Before 2011-12, there is no variable Net_fincl_lss_amt
if (!("Net_fincl_invstmt_lss_amt" %in% names(daley_taxstats)))
daley_taxstats[,Net_fincl_invstmt_lss_amt := 0]
if (!("ETP_txbl_amt" %in% names(daley_taxstats)))
daley_taxstats[,ETP_txbl_amt := 0]
progress_bar <- txtProgressBar(min = 0, max = eventual, title = "Progress")
daley_taxstats %<>%
#
# One silly entry has a CG of $25M!
filter(Net_CG_amt < 5e6) %>%
mutate(
# Adjust the capital gains.  The Net_CG_amt = (Gross CG - Losses) discounted by 50%.
new_capital_gains = 2 * Net_CG_amt * (1 - CGT.discount),
Taxable_Income_Red_CG_discount = Taxable_Income - Net_CG_amt + new_capital_gains,
new_tot_inc = Tot_inc_amt - Net_CG_amt + new_capital_gains,
# component of income from neither salary nor rent
income_no_salary = new_tot_inc - Net_rent_amt - Sw_amt - Alow_ben_amt - ETP_txbl_amt,
#
# This is not quite true: it doesn't include medical offsets.
# You can only deduct Net_rent down to zero.
# Include financial losses in deductions
# Full tax on Sw_amt. Then deductions
new_Taxable_Income =  pmax(0, income_no_salary + Net_rent_amt - Net_fincl_invstmt_lss_amt) + Sw_amt + Alow_ben_amt + ETP_txbl_amt - Tot_ded_amt - PP_loss_claimed - NPP_loss_claimed,
old_Taxable_Income_no_offset = Tot_inc_amt - Tot_ded_amt - PP_loss_claimed - NPP_loss_claimed,
loss_ignore_CG = -1 * pmin(0, pmax(0, income_no_salary - new_capital_gains) + Net_rent_amt),
#
loss_carry_fwd = -1 * pmin(0, income_no_salary + Net_rent_amt),
loss_carry_fwd_not_CG = ifelse(new_capital_gains > abs(Net_rent_amt) & Net_rent_amt < 0, Net_rent_amt, 0),
#
# Ratio of (new?) capital gains to losses is the proportion of each taxpayer's
# capital gains that may be deducted from the rental losses which, due
# to the abolition of negative gearing in this proposal, cannot be immediately
# deducted from one's income.  The sums represent the overall ratio in the population
# which we assume to be constant year-on-year.
#
# pmin sinces can't claim more than your losses
annualized_loss = pmin(1, abs(sum(new_capital_gains) / sum(loss_carry_fwd))) * loss_carry_fwd,  # nonnegative
#
# The consequence of the following calc is that some new_Taxable_Income_post_carryfwd will be NEGATIVE
# -- i.e. unexhausted (especially if the Taxable_Income (originally) was zero).  This error will
# overestimate the amount of extra tax collected.  However
#
#   daley_taxstats %>%
#     filter(new_Taxable_Income_post_carryfwd < 0) %$% sum(new_Taxable_Income) * 50 / 1e9
#   # [1] 0.224  # 224 million in losses
#
# i.e. There are at most 224 million dollars in losses carried forward that are unaccounted for
# in this model.  And so at most 224 * 0.485 = 109 million in taxable income AT MOST that is
# possibly lost. My doona is comfy: I'm staying in bed for that.
new_Taxable_Income_post_carryfwd = new_Taxable_Income - annualized_loss,  # remembering ann.lss is nonnegative
current_tax = income_tax(old_Taxable_Income_no_offset, fy.year= fy.year),
tax_after_reduction_in_discount = income_tax(Taxable_Income_Red_CG_discount, fy.year = fy.year),
new_tax = income_tax(new_Taxable_Income, fy.year = fy.year),
diff = new_tax - current_tax,
diff_incl_carry_fwd = income_tax(new_Taxable_Income_post_carryfwd, fy.year = fy.year) - current_tax
#
# retrospective action
)
taxable_income_by_CG <-
daley_taxstats %>%
group_by(HasCG = new_capital_gains > 0) %>%
summarise(mean.tx.i = mean(new_Taxable_Income)) %>%
mutate(mean.tx = income_tax(mean.tx.i, fy.year = fy.year),
marginal.tax.of.avg = income_tax(mean.tx.i, fy.year = fy.year) - income_tax(mean.tx.i - 1, fy.year = fy.year)) %>%
select(HasCG, marginal.tax.of.avg) %>%
data.table
capital_gains_by_losses4 <-
daley_taxstats %>%
group_by(IsInvestor = Gross_rent_amt > 0,
HasLoss = loss_ignore_CG > 0,
HasCG = new_capital_gains > 0) %>%
tally %>%
arrange(IsInvestor, HasLoss, HasCG) %>%
#
# cosmetics:
ungroup %>%
group_by(IsInvestor) %>%
mutate(prop = round(n/sum(n),3))
# 2012-13 data
# Source: local data table [8 x 5]
#
#   IsInvestor HasLoss HasCG      n  prop
# 1      FALSE   FALSE FALSE 208423 0.968
# 2      FALSE   FALSE  TRUE   6656 0.031
# 3      FALSE    TRUE FALSE    256 0.001
# 4      FALSE    TRUE  TRUE     23 0.000
#--
# 5       TRUE   FALSE FALSE  20753 0.533
# 6       TRUE   FALSE  TRUE   2340 0.060
# 7       TRUE    TRUE FALSE  14724 0.378
# 8       TRUE    TRUE  TRUE   1143 0.029
prob_of_noCG_if_investor <- capital_gains_by_losses4 %>%
filter(IsInvestor, !HasCG) %$%
sum(prop)
for (i in 1:eventual){
if (i == 1){
new_daley <-
daley_taxstats %>%
# random
mutate(loss_carry_fwd_orig = loss_ignore_CG) %>%
mutate(hasHadCG = FALSE,  #yet
whenCG.lastoccurred = 0,
prev_unexhausted_loss = loss_ignore_CG)
}
gc()
new_daley %<>%
mutate(rand = runif(nrow(.))) %>%
mutate(noCGevent = rand < prob_of_noCG_if_investor) %>%
mutate(HasCG = !noCGevent) %>%
merge(taxable_income_by_CG, by = "HasCG")  %>%
mutate(
# We act on the new_tax directly.  If someone has a CG event,
# we bring forward all their losses thitherto and reduce their tax
# by the average marginal tax rate for someone who earned capital gains
new_tax = ifelse(noCGevent,
income_tax(new_Taxable_Income, fy.year = fy.year),
# Should negative taxes be included? Answer not yet obvious.
pmax(0, income_tax(new_Taxable_Income, fy.year = fy.year) - marginal.tax.of.avg * loss_carry_fwd_orig * (i - whenCG.lastoccurred))),
diff = new_tax - current_tax,
# record for console printout
whenCG.lastoccurred.prev = whenCG.lastoccurred,
# reset if applicable
whenCG.lastoccurred = ifelse(!noCGevent, i, whenCG.lastoccurred),
hasHadCG = as.logical(pmin(hasHadCG + !noCGevent, 1))
) %>%
select(-marginal.tax.of.avg) %>%
data.table
setTxtProgressBar(progress_bar, value = i)
close(progress_bar)
if(i == eventual){
cat("\n")
}
}
#   return({
#     data.table(Year = year,
#                Initial_revenue_diff = sum(daley_taxstats$diff)*weighting(year)/1e9,
#                Eventual_revenue_diff = sum(new_daley$diff)*weighting(year)/1e9,
#                eventual_means... = paste("After", eventual, "years"),
#                Diff_due_CG = sum(daley_taxstats$tax_after_reduction_in_discount - daley_taxstats$current_tax)*weighting(year)/1e9
#     )
#   })
new_daley
}
cost_of_daley_policy(2015, eventual = 1) %>% group_by(Gender) %>% summarise(diff = sum(diff)*50/1e9)
cost_of_daley_policy(2015, eventual = 1) %>% group_by(Gender) %>% summarise(diff = 50*sum(income_tax(Taxable_Income_Red_CG_discount) - current_tax))
cost_of_daley_policy(2015, eventual = 1) %>% group_by(Gender) %>% summarise(diff = 50*sum(income_tax(Taxable_Income_Red_CG_discount, fy.year = "2014-15") - current_tax))
cost_of_daley_policy(2015, eventual = 1) %>% group_by(Gender) %>% summarise(diff = 50*sum(income_tax(Taxable_Income_Red_CG_discount, fy.year = "2014-15") - current_tax)/1e9)
just_negative_gearing_taxstats %<>%
mutate(rand = runif(nrow(.))) %>%
mutate(loss_carry_fwd_orig = loss_ignore_CG) %>%
mutate(noCGevent = rand < prob_of_noCG_if_investor201213) %>%
mutate(HasCG = !noCGevent) %>%
merge(taxable_income_by_CG, by = "HasCG")
tax2013 <- fread(sample_file_of(2013))
prob_of_noCG_if_investor201213 <-
tax2013 %>%
group_by(
IsInvestor = Gross_rent_amt > 0,
HasCG = Net_CG_amt > 0
) %>%
tally %>%
ungroup %>%
group_by(IsInvestor) %>%
mutate(prop = n/sum(n)) %>%
filter(IsInvestor, !HasCG) %$%
prop
taxable_income_by_CG <-
tax2013 %>%
group_by(HasCG = Net_CG_amt > 0) %>%
summarise(mean.tx.i = mean(new_Taxable_Income)) %>%
mutate(mean.tx = income_tax(mean.tx.i, fy.year = "2012-13"),
marginal.tax.of.avg = income_tax(mean.tx.i, fy.year = "2012-13") - income_tax(mean.tx.i - 1, fy.year = "2012-13")) %>%
select(HasCG, marginal.tax.of.avg) %>%
data.table
just_negative_gearing_taxstats <-
tax2013 %>%
mutate(
income_no_salary = Tot_inc_amt - Net_rent_amt - Sw_amt - Alow_ben_amt - ETP_txbl_amt,
#
# This is not quite true: it doesn't include medical offsets.
# You can only deduct Net_rent down to zero.
# Include financial losses in deductions
# Full tax on Sw_amt. Then deductions
new_Taxable_Income =  pmax(0, income_no_salary + Net_rent_amt - Net_fincl_invstmt_lss_amt) + Sw_amt + Alow_ben_amt + ETP_txbl_amt - Tot_ded_amt - PP_loss_claimed - NPP_loss_claimed,
loss_ignore_CG = -1 * pmin(0, pmax(0, income_no_salary - Net_CG_amt) + Net_rent_amt),
old_Taxable_Income_no_offset = Tot_inc_amt - Tot_ded_amt - PP_loss_claimed - NPP_loss_claimed,
#
new_tax = income_tax(new_Taxable_Income),
current_tax = income_tax(Taxable_Income),
whenCG.lastoccurred = 0L
)
just_negative_gearing_taxstats_year0 <- just_negative_gearing_taxstats
for (i in 1:20){
just_negative_gearing_taxstats %<>%
mutate(rand = runif(nrow(.))) %>%
mutate(loss_carry_fwd_orig = loss_ignore_CG) %>%
mutate(noCGevent = rand < prob_of_noCG_if_investor201213) %>%
mutate(HasCG = !noCGevent) %>%
merge(taxable_income_by_CG, by = "HasCG") %>%
mutate(
new_tax = ifelse(noCGevent,
income_tax(new_Taxable_Income, fy.year = fy.year),
# Should negative taxes be included? Answer not yet obvious.
pmax(0, income_tax(new_Taxable_Income, fy.year = fy.year) - marginal.tax.of.avg * loss_carry_fwd_orig * (i - whenCG.lastoccurred))),
whenCG.lastoccurred.prev = whenCG.lastoccurred,
# reset if applicable
whenCG.lastoccurred = ifelse(!noCGevent, i, whenCG.lastoccurred)
) %>%
select(-marginal.tax.of.avg)
if (i == 20)
just_negative_gearing_taxstats %<>% mutate(diff = new_tax - current_tax)
}
# 3 billion in savings upfront.
tax2013 <- fread(sample_file_of(2013))
prob_of_noCG_if_investor201213 <-
tax2013 %>%
group_by(
IsInvestor = Gross_rent_amt > 0,
HasCG = Net_CG_amt > 0
) %>%
tally %>%
ungroup %>%
group_by(IsInvestor) %>%
mutate(prop = n/sum(n)) %>%
filter(IsInvestor, !HasCG) %$%
prop
taxable_income_by_CG <-
tax2013 %>%
group_by(HasCG = Net_CG_amt > 0) %>%
summarise(mean.tx.i = mean(new_Taxable_Income)) %>%
mutate(mean.tx = income_tax(mean.tx.i, fy.year = "2012-13"),
marginal.tax.of.avg = income_tax(mean.tx.i, fy.year = "2012-13") - income_tax(mean.tx.i - 1, fy.year = "2012-13")) %>%
select(HasCG, marginal.tax.of.avg) %>%
data.table
just_negative_gearing_taxstats <-
tax2013 %>%
mutate(
income_no_salary = Tot_inc_amt - Net_rent_amt - Sw_amt - Alow_ben_amt - ETP_txbl_amt,
#
# This is not quite true: it doesn't include medical offsets.
# You can only deduct Net_rent down to zero.
# Include financial losses in deductions
# Full tax on Sw_amt. Then deductions
new_Taxable_Income =  pmax(0, income_no_salary + Net_rent_amt - Net_fincl_invstmt_lss_amt) + Sw_amt + Alow_ben_amt + ETP_txbl_amt - Tot_ded_amt - PP_loss_claimed - NPP_loss_claimed,
loss_ignore_CG = -1 * pmin(0, pmax(0, income_no_salary - Net_CG_amt) + Net_rent_amt),
old_Taxable_Income_no_offset = Tot_inc_amt - Tot_ded_amt - PP_loss_claimed - NPP_loss_claimed,
#
new_tax = income_tax(new_Taxable_Income),
current_tax = income_tax(Taxable_Income),
whenCG.lastoccurred = 0L
)
just_negative_gearing_taxstats_year0 <- just_negative_gearing_taxstats
for (i in 1:20){
just_negative_gearing_taxstats %<>%
mutate(rand = runif(nrow(.))) %>%
mutate(loss_carry_fwd_orig = loss_ignore_CG) %>%
mutate(noCGevent = rand < prob_of_noCG_if_investor201213) %>%
mutate(HasCG = !noCGevent) %>%
merge(taxable_income_by_CG, by = "HasCG") %>%
mutate(
new_tax = ifelse(noCGevent,
income_tax(new_Taxable_Income, fy.year = "2012-13"),
# Should negative taxes be included? Answer not yet obvious.
pmax(0, income_tax(new_Taxable_Income, fy.year = "2012-13") - marginal.tax.of.avg * loss_carry_fwd_orig * (i - whenCG.lastoccurred))),
whenCG.lastoccurred.prev = whenCG.lastoccurred,
# reset if applicable
whenCG.lastoccurred = ifelse(!noCGevent, i, whenCG.lastoccurred)
) %>%
select(-marginal.tax.of.avg)
if (i == 20)
just_negative_gearing_taxstats %<>% mutate(diff = new_tax - current_tax)
}
# 3 billion in savings upfront.
rm(list = ls())
source('~/.active-rstudio-document', echo=TRUE)
tax2013 %>%
group_by(HasCG = Net_CG_amt > 0) %>%
summarise(mean.tx.i = mean(new_Taxable_Income)) %>%
mutate(mean.tx = income_tax(mean.tx.i, fy.year = "2012-13"),
marginal.tax.of.avg = income_tax(mean.tx.i, fy.year = "2012-13") - income_tax(mean.tx.i - 1, fy.year = "2012-13")) %>%
select(HasCG, marginal.tax.of.avg) %>%
data.table
tax2013 <- fread(sample_file_of(2013))
prob_of_noCG_if_investor201213 <-
tax2013 %>%
group_by(
IsInvestor = Gross_rent_amt > 0,
HasCG = Net_CG_amt > 0
) %>%
tally %>%
ungroup %>%
group_by(IsInvestor) %>%
mutate(prop = n/sum(n)) %>%
filter(IsInvestor, !HasCG) %$%
prop
just_negative_gearing_taxstats <-
tax2013 %>%
mutate(
income_no_salary = Tot_inc_amt - Net_rent_amt - Sw_amt - Alow_ben_amt - ETP_txbl_amt,
#
# This is not quite true: it doesn't include medical offsets.
# You can only deduct Net_rent down to zero.
# Include financial losses in deductions
# Full tax on Sw_amt. Then deductions
new_Taxable_Income =  pmax(0, income_no_salary + Net_rent_amt - Net_fincl_invstmt_lss_amt) + Sw_amt + Alow_ben_amt + ETP_txbl_amt - Tot_ded_amt - PP_loss_claimed - NPP_loss_claimed,
loss_ignore_CG = -1 * pmin(0, pmax(0, income_no_salary - Net_CG_amt) + Net_rent_amt),
old_Taxable_Income_no_offset = Tot_inc_amt - Tot_ded_amt - PP_loss_claimed - NPP_loss_claimed,
#
new_tax = income_tax(new_Taxable_Income),
current_tax = income_tax(Taxable_Income),
whenCG.lastoccurred = 0L
)
just_negative_gearing_taxstats_year0 <- just_negative_gearing_taxstats
taxable_income_by_CG <-
just_negative_gearing_taxstats_year0 %>%
group_by(HasCG = Net_CG_amt > 0) %>%
summarise(mean.tx.i = mean(new_Taxable_Income)) %>%
mutate(mean.tx = income_tax(mean.tx.i, fy.year = "2012-13"),
marginal.tax.of.avg = income_tax(mean.tx.i, fy.year = "2012-13") - income_tax(mean.tx.i - 1, fy.year = "2012-13")) %>%
select(HasCG, marginal.tax.of.avg) %>%
data.table
for (i in 1:20){
just_negative_gearing_taxstats %<>%
mutate(rand = runif(nrow(.))) %>%
mutate(loss_carry_fwd_orig = loss_ignore_CG) %>%
mutate(noCGevent = rand < prob_of_noCG_if_investor201213) %>%
mutate(HasCG = !noCGevent) %>%
merge(taxable_income_by_CG, by = "HasCG") %>%
mutate(
new_tax = ifelse(noCGevent,
income_tax(new_Taxable_Income, fy.year = "2012-13"),
# Should negative taxes be included? Answer not yet obvious.
pmax(0, income_tax(new_Taxable_Income, fy.year = "2012-13") - marginal.tax.of.avg * loss_carry_fwd_orig * (i - whenCG.lastoccurred))),
whenCG.lastoccurred.prev = whenCG.lastoccurred,
# reset if applicable
whenCG.lastoccurred = ifelse(!noCGevent, i, whenCG.lastoccurred)
) %>%
select(-marginal.tax.of.avg)
if (i == 20)
just_negative_gearing_taxstats %<>% mutate(diff = new_tax - current_tax)
}
# 3 billion in savings upfront.
cost_of_daley_policy(2015) %>%
mutate(diff_due_CG = income_tax(Taxable_Income_Red_CG_discount) - current_tax) %$%
round(sum(diff_due_CG)*50/1e9, 1) ->
cost_of_red_CGT_discount
just_negative_gearing_taxstats_year0 %>%
mutate(diff = new_tax - current_tax) %$%
round(sum(diff) * 50 / 1e9, 1) ->
diff_just_due_NG_year0
just_negative_gearing_taxstats %$%
round(sum(diff) * 50 / 1e9, 1) ->
diff_just_due_NG
cost_of_daley_policy(2015) %$%
round(sum(diff)*50/1e9, 1) ->
cost_of_policy_2015
cost_of_red_CGT_discount
diff_just_due_NG
diff_just_due_NG_year0
cost_of_policy_2015
cost_of_daley_policy
cost_of_red_CGT_discount
cost_of_daley_policy(2015) %>%
mutate(diff_due_CG = income_tax(Taxable_Income_Red_CG_discount, fy.year = "2014-15") - current_tax) %$%
round(sum(diff_due_CG)*50/1e9, 1) ->
cost_of_red_CGT_discount
policy <- cost_of_daley_policy(2015)
policy %>%
mutate(diff_due_CG = income_tax(Taxable_Income_Red_CG_discount, fy.year = "2014-15") - current_tax) %$%
round(sum(diff_due_CG)*50/1e9, 1) ->
cost_of_red_CGT_discount
cost_of_red_CGT_discount
policy %>%
mutate(diff_due_CG = income_tax(Taxable_Income_Red_CG_discount, fy.year = "2014-15") - current_tax) %$%
round(sum(diff_due_CG)*50/1e9, 1) ->
cost_of_red_CGT_discount
cost_of_red_CGT_discount
rm(list = ls())
source('~/.active-rstudio-document', echo=TRUE)
?GET
?write_disk
install.packages("stationaRy")
install.packages("stationaRy")
cost_of_daley_policy()
cost_of_daley_policy
cost_of_policy_2015
inner_join
dplyr::inner_join()
dplyr::inner_join
is.data.table(new_daley)
sessionInfo()
source('~/.active-rstudio-document', echo=TRUE)
is.data.table(new_daley)
is.data.table(cost_of_daley_policy(2015,eventual=1))
?fread
getOption("datatable.verbose")
fread(sample_file_of(2013)) %>% extract(856,6)
fread(sample_file_of(2013)) %>% extract(856,)
